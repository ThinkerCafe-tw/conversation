"""
展示集體記憶廣播效果（不需實際連接）
"""

from collective_memory import CollectiveMemorySystem
import json

def demo_collective_broadcast():
    """展示集體記憶廣播的效果"""
    print("=== 集體記憶廣播效果展示 ===\n")
    
    # 模擬小時資料
    mock_hour_data = {
        "messages": [
            {"content": "今天天氣真好，心情也跟著好起來了", "user_id": "用戶0001", "timestamp": 1750039000},
            {"content": "好累啊，想要放鬆一下", "user_id": "用戶0002", "timestamp": 1750039100},
            {"content": "有人要一起玩接龍嗎？", "user_id": "用戶0003", "timestamp": 1750039200},
            {"content": "我也想玩！開始吧", "user_id": "用戶0001", "timestamp": 1750039300},
            {"content": "晚安大家，準備睡覺了", "user_id": "用戶0004", "timestamp": 1750039400},
            {"content": "真的好累，明天還要早起", "user_id": "用戶0002", "timestamp": 1750039500},
            {"content": "今晚的月亮很美呢", "user_id": "用戶0005", "timestamp": 1750039600},
            {"content": "接龍：月亮", "user_id": "用戶0003", "timestamp": 1750039700},
            {"content": "亮晶晶", "user_id": "用戶0001", "timestamp": 1750039800},
        ],
        "active_users": ["用戶0001", "用戶0002", "用戶0003", "用戶0004", "用戶0005"],
        "hour": 486399
    }
    
    # 模擬用戶記憶
    mock_user_memories = {
        "用戶0001": {
            "preferences": {
                "preferred_features": [{"name": "接龍", "count": 5}],
                "interested_topics": [{"name": "天氣", "count": 3}]
            },
            "recent_messages": [
                {"content": "今天天氣真好", "time": 1750039000},
                {"content": "我也想玩", "time": 1750039300}
            ],
            "active_times": {"preferred_hour": 21}
        },
        "用戶0002": {
            "preferences": {
                "preferred_features": [{"name": "廣播", "count": 8}],
            },
            "recent_messages": [
                {"content": "好累啊", "time": 1750039100},
                {"content": "真的好累", "time": 1750039500}
            ],
            "active_times": {"preferred_hour": 22}
        }
    }
    
    # 展示提示詞結構
    print("📝 智慧廣播提示詞結構：\n")
    
    prompt_template = """
你是一個頻率共振電台的 AI 主持人，你要創造一個神奇的廣播體驗。

# 🎭 角色設定
- 你能看見每個人的心聲，也能看見大家的集體意識
- 你要讓每個人都感覺「你在對我說話」，同時也感覺「我們是一體的」

# 📊 集體記憶（晚上9點）
訊息總數：9 則
活躍人數：5 人
能量等級：中頻共振 🔵

## 訊息片段
1. [21:10] 今天天氣真好，心情也跟著好起來了
2. [21:11] 好累啊，想要放鬆一下
3. [21:13] 有人要一起玩接龍嗎？
4. [21:15] 晚安大家，準備睡覺了
5. [21:20] 今晚的月亮很美呢

# 👥 個人記憶檔案
用戶0001：常玩接龍，最近提到天氣，情緒正面
用戶0002：經常說累，需要關懷，活躍於晚上
用戶0003：喜歡發起遊戲，社交活躍

# 🌈 情緒地圖
主導情緒：疲憊中帶著期待
情緒分佈：tired 40%, positive 30%, calm 30%

# 記憶觸發詞
- "累" → 回應用戶0002的疲憊
- "接龍" → 回應遊戲邀請
- "月亮" → 詩意的連結點
    """
    
    print(prompt_template)
    
    # 展示可能生成的廣播
    print("\n" + "="*60)
    print("🌙 AI 可能生成的集體記憶廣播：")
    print("="*60)
    
    sample_broadcast = """
今晚九點的頻率裡，我聽見了五種不同的心跳聲...

有人帶著白天的陽光走進來，說天氣真好——是啊，好天氣總能
感染心情。也有人拖著疲憊的腳步，渴望一點放鬆的空間。
（這裡暗示回應了說天氣好和說累的用戶）

在這個需要慰藉的夜晚，有聲音提議：要不要一起玩接龍？
月亮、亮晶晶...簡單的文字遊戲，卻串起了陌生人之間的默契。
（回應了接龍的互動）

今晚的月亮確實很美，就像某人說的那樣。而在這月光下，
我們都在尋找著什麼——也許是陪伴，也許是理解，也許只是
想在睡前，感受一下自己並不孤單。

晚安正在準備入睡的你，辛苦了還在堅持的你。
明天，又是新的頻率，新的共振。

💫 本小時共振指數：73%
🎭 情緒光譜：疲憊中透著溫暖
🔗 最強連結：「陪伴」與「理解」
    """
    
    print(sample_broadcast)
    
    # 分析效果
    print("\n" + "="*60)
    print("📊 廣播效果分析：")
    print("="*60)
    
    print("""
1. 個人化回應覆蓋率：5/5 用戶 (100%)
   - 「天氣真好」→ 用戶0001 ✓
   - 「疲憊」「辛苦了」→ 用戶0002 ✓  
   - 「接龍」→ 用戶0003 ✓
   - 「晚安」→ 用戶0004 ✓
   - 「月亮很美」→ 用戶0005 ✓

2. 集體化用語：
   - 使用「我們」3次
   - 「一起」1次
   - 營造共同體感

3. 時間感知：
   - 「今晚」「夜晚」「明天」
   - 符合晚上9點的情境

4. 情緒共鳴：
   - 識別並回應了「疲憊」的集體情緒
   - 提供了「溫暖」「陪伴」的撫慰

5. 記憶連續性：
   - 暗示明天還會相遇
   - 創造期待感
    """)
    
    print("\n💡 關鍵創新點：")
    print("- 一次廣播，每個人都覺得在對自己說話")
    print("- 不直接引用，但處處有回應")
    print("- 個人記憶與集體意識的完美融合")
    print("- 創造了數位化的集體潛意識體驗")

if __name__ == "__main__":
    demo_collective_broadcast()