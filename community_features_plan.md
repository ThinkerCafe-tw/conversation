# 🌊 頻率共振 LINE Bot - 社群功能規劃

## 🎯 核心理念
透過群眾智慧和文字互動，建立一個零成本、高價值的社群平台，平時娛樂互動，戰時互助支援。

## 📊 功能架構

### 1. 🎮 娛樂互動功能（平時）

#### 📝 文字接龍
```
用戶A: 接龍 蘋果
Bot: 🎯 接龍開始！當前詞：蘋果
用戶B: 果汁
Bot: ✅ 接龍成功！當前詞：果汁（2/10）
用戶C: 汁液
Bot: ✅ 接龍成功！當前詞：汁液（3/10）
[達到10個後]
Bot: 🎊 接龍完成！參與者：用戶A、B、C...
本次接龍：蘋果→果汁→汁液→...
```

#### 🗳️ 即時投票
```
用戶: 投票 今晚吃什麼？火鍋/燒烤/日料
Bot: 📊 投票開始！主題：今晚吃什麼？
1️⃣ 火鍋 (0票)
2️⃣ 燒烤 (0票)  
3️⃣ 日料 (0票)
回覆數字投票，輸入「投票結果」查看
```

#### 💝 匿名交友配對
```
用戶: 交友 喜歡爬山和閱讀
Bot: 💝 已記錄您的興趣！
目前有3位用戶也喜歡爬山
輸入「配對」開始匹配
```

#### 😄 每日笑話收集
```
用戶: 笑話 為什麼程式設計師不喜歡大自然？因為有太多bugs
Bot: 😄 笑話已收錄！今日笑話庫：23則
本日最受歡迎：[顯示高讚笑話]
```

### 2. 🚨 防災互助功能（戰時/緊急）

#### 🏠 避難所資訊
```
用戶: 防空 台北市大安區和平東路有地下停車場可容納200人
Bot: 🏠 避難資訊已記錄
地點：台北市大安區和平東路
類型：地下停車場
容量：200人
狀態：待驗證（需3人確認）
```

#### 🥫 物資共享
```
用戶: 物資 提供：飲用水10箱，地點：信義區，聯絡：0912xxx
Bot: 🥫 物資資訊已登記
提供者：用戶編號#1234
物資：飲用水10箱
地點：信義區（已模糊化）
```

#### 🚑 緊急求助
```
用戶: 緊急 需要醫療協助，地點：[自動隱藏]
Bot: 🚨 緊急求助已發布
求助類型：醫療
附近醫護人員將收到通知
請保持冷靜，協助正在路上
```

### 3. 📈 API 使用統計與管理

#### 即時用量顯示
```
用戶: API統計
Bot: 📊 Gemini API 使用狀況
本日：234/1500 次 (15.6%)
本月：4,521/45,000 次 (10%)
預估月底：13,500次
狀態：✅ 正常
```

## 🔧 技術實作方案

### 指令系統設計
```python
COMMANDS = {
    # 娛樂功能
    "接龍": handle_word_chain,
    "投票": handle_voting,
    "交友": handle_friendship,
    "笑話": handle_joke,
    
    # 防災功能
    "防空": handle_shelter,
    "物資": handle_supplies,
    "緊急": handle_emergency,
    
    # 系統功能
    "統計": handle_stats,
    "API統計": handle_api_stats,
    "廣播": handle_broadcast,
    "幫助": handle_help
}
```

### 資料結構設計

#### 1. 文字接龍
```python
word_chains: {
    "chain_id": {
        "current_word": "蘋果",
        "chain": ["蘋果", "果汁", "汁液"],
        "participants": ["user1", "user2"],
        "created_at": timestamp,
        "target_length": 10
    }
}
```

#### 2. 投票系統
```python
votes: {
    "vote_id": {
        "topic": "今晚吃什麼？",
        "options": ["火鍋", "燒烤", "日料"],
        "votes": {"option1": ["user1"], "option2": ["user2"]},
        "created_by": "user_id",
        "expires_at": timestamp
    }
}
```

#### 3. 防災資訊
```python
emergency_info: {
    "shelters": [{
        "location": "加密地址",
        "type": "地下停車場",
        "capacity": 200,
        "verified_by": ["user1", "user2"],
        "last_updated": timestamp
    }],
    "supplies": [{
        "type": "飲用水",
        "quantity": "10箱",
        "location_hash": "區域代碼",
        "provider": "匿名用戶#1234",
        "status": "available"
    }]
}
```

### 廣播內容結構
```
🌊 頻率廣播 #024
📅 2024-06-16 08:00
━━━━━━━━━━━━━━

【即時共振】
今晨的頻率中，充滿了對新一天的期待...
（Gemini 生成的內容摘要）

【社群互動】
🎯 本小時完成3輪文字接龍
📊 進行中投票：週末活動（山友會 65%領先）
💝 新增12位交友配對

【防災資訊庫】（固定累積區）
🏠 已驗證避難所：152處
🥫 可用物資點：89處
📍 最新更新：大安區新增防空避難所

【API 使用量】
Gemini API: 234/1500 (15.6%)

━━━━━━━━━━━━━━
💬 1,234個聲音參與共振
✨ 輸入「幫助」查看所有功能
```

## 📱 使用者體驗流程

### 新用戶引導
```
新用戶加入群組
↓
Bot: 歡迎加入頻率共振！🌊
這是一個由大家共同創造的社群
輸入「幫助」了解所有功能
輸入任意文字開始貢獻
↓
用戶發送第一則訊息
↓
Bot: 🎉 第1則！歡迎加入共振
您可以試試：
- 接龍 [詞語] 開始文字遊戲
- 投票 [主題] 發起投票
- 防空 [資訊] 提供避難資訊
```

### 防災模式切換
```python
def check_emergency_mode():
    # 根據關鍵詞密度判斷
    emergency_keywords = ["警報", "空襲", "避難", "緊急"]
    if keyword_density > threshold:
        activate_emergency_mode()
        # 優先顯示防災資訊
        # 減少娛樂功能提示
```

## 🔐 隱私保護機制

1. **用戶匿名化**
   - 所有用戶以編號顯示（用戶#1234）
   - 敏感地址自動模糊化
   - 聯絡資訊加密儲存

2. **資訊驗證**
   - 防災資訊需3人確認才標記為「已驗證」
   - 可疑資訊自動標記
   - 社群檢舉機制

3. **資料生命週期**
   - 娛樂資料：24小時
   - 投票資料：72小時  
   - 防災資料：長期保存但定期更新驗證

## 💡 創新功能建議

### 1. 情緒天氣圖
根據群組訊息分析整體情緒，生成每日情緒報告

### 2. 技能交換市集
用戶可以列出自己的技能，戰時可快速找到需要的專業人士

### 3. 謠言終結者
結合 Gemini API 自動識別和標記可疑資訊

### 4. 鄰里守望
根據地理位置自動建立小區域互助網絡

## 🚀 實施優先順序

### Phase 1（立即實施）
1. API 統計功能
2. 文字接龍
3. 簡單投票
4. 基礎防空資訊收集

### Phase 2（一週內）
1. 交友配對
2. 物資共享系統
3. 廣播優化（分區塊顯示）

### Phase 3（一個月內）
1. 緊急求助系統
2. 資訊驗證機制
3. 進階統計分析

## 📊 成功指標

1. **日活躍用戶**: 100+ 
2. **每日訊息數**: 1000+
3. **API 使用率**: <30%免費額度
4. **防災資訊數**: 100+筆驗證資訊
5. **用戶滿意度**: 90%+正面回饋

這個系統充分利用了文字的免費特性，最小化 API 使用，最大化社群價值！